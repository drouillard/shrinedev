Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=[],o=arguments[1],r=0;n>r;r++)if(r in t){var a=t[r];e.call(o,a,r,t)&&i.push(a)}return i}),function(e){function t(e,t){var n=e[1]-e[0],i=t[1]-t[0];return e[0]-t[0]>=0&&e[0]-t[0]<i?!0:e[0]-t[0]<=0&&e[0]+n>t[0]?!0:!1}var n={spytarget:window,scrolltopoffset:0,scrollbehavior:"smooth",scrollduration:500,highlightclass:"selected",mincontentheight:30};e.fn.ddscrollSpy=function(i){var o=e(window),r=e(window.opera?"CSS1Compat"==document.compatMode?"html":"body":"html,body");return this.each(function(){function a(t){var n=t.find('a[href^="#"]');u=[],d="",n.each(function(t){var n=e(this),i=e(n.attr("href")),o=i.get(0);if(0==i.length)return!0;n.off("click.goto").on("click.goto",function(e){if(c.spytarget!=window||"jump"!=c.scrollbehavior&&history.pushState||(window.location.hash=n.attr("href")),"smooth"==c.scrollbehavior||0!=c.scrolltopoffset){var i=c.spytarget==window?r:p,o=document.all&&!window.Worker?1:0;"smooth"!=c.scrollbehavior||!history.pushState&&c.spytarget==window?i.prop("scrollTop",u[t].offsettop+o):i.animate({scrollTop:u[t].offsettop+o},c.scrollduration,function(){c.spytarget==window&&history.pushState&&history.pushState(null,null,n.attr("href"))}),e.preventDefault()}});var a=c.spytarget==window?i.offset().top:o.offsetParent==c.spytarget?o.offsetTop:o.offsetTop-c.spytarget.offsetTop;a+=c.scrolltopoffset;var s=parseInt(i.data("spyrange"))>0?parseInt(i.data("spyrange")):i.outerHeight()||c.mincontentheight;u.push({$menuitem:n,$des:i,offsettop:a,height:s})})}function s(){1==d.length&&d.removeClass(c.highlightclass);var e=p.scrollTop(),n=p.outerHeight(),i=u.filter(function(i){return t([i.offsettop,i.offsettop+i.height],[e,e+n])});i.length>0&&(d=i.shift().$menuitem.addClass(c.highlightclass))}function l(){if(void 0!=e)var e=u[0].$menu;else var e=null;for(var t=0;t<u.length;t++){var n=u[t].$des,i=n.get(0),o=c.spytarget==window?n.offset().top:i.offsetParent==c.spytarget?i.offsetTop:i.offsetTop-c.spytarget.offsetTop;o+=c.scrolltopoffset,u[t].offsettop=o,u[t].height=parseInt(n.data("spyrange"))>0?parseInt(n.data("spyrange")):n.outerHeight()||c.mincontentheight}}var c=e.extend({},n,i),u=[],d="",p=e(c.spytarget).eq(0),f=e(this);a(f),f.on("updatespy",function(){a(f),s()}),p.on("scroll resize",function(){s()}),s(),o.on("load",function(){l()})})}}(jQuery);